{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/caio/Applications/mern-exercise-tracker/client/src/views/users/Users.js\";\nimport React from \"react\";\nimport { Table, Button, Badge, Spinner } from \"react-bootstrap\";\nimport UserComponent from \"./User\";\nimport Modal from \"../../components/Modal\";\nimport Toast from \"../../components/Toast\";\nimport User from \"../../api/User\";\nimport Form from \"./Form\";\nconst defaultForm = {\n  name: \"\",\n  email: \"\",\n  password: \"\",\n  password_confirmation: \"\",\n  _id: null\n};\nexport default class Users extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      users: [],\n      errors: [],\n      user: null,\n      busy: false,\n      selected: [],\n      activeModal: false,\n      form: defaultForm,\n      mode: \"create\"\n    };\n    this.closeModal = this.closeModal.bind(this);\n    this.openModal = this.openModal.bind(this);\n    this.setBusyState = this.setBusyState.bind(this);\n    this.toggleSelected = this.toggleSelected.bind(this);\n    this.setErrors = this.setErrors.bind(this);\n    this.clearErrors = this.clearErrors.bind(this);\n    this.show = this.show.bind(this);\n    this.users = this.users.bind(this);\n    this.store = this.store.bind(this);\n    this.update = this.update.bind(this);\n    this.delete = this.delete.bind(this);\n    this.clear = this.clear.bind(this);\n    this.fill = this.fill.bind(this);\n    this.add = this.add.bind(this);\n    this.edit = this.edit.bind(this);\n    this.changeMode = this.changeMode.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  async users() {\n    this.setBusyState(true);\n    await User.get().then(({\n      data\n    }) => {\n      this.setState({\n        users: data\n      });\n      this.setBusyState(false);\n    }).catch(err => {\n      console.log(err.response);\n      this.setBusyState(false);\n    });\n  }\n\n  async store() {\n    await User.store(this.state.form).then(({\n      data\n    }) => {\n      this.setState({\n        users: [...this.state.users, data]\n      });\n      this.closeModal();\n    }).catch(err => {\n      console.log(err.response);\n\n      if (err.response.status === 400) {\n        this.setErrors(err.response.data.errors || []);\n      }\n    });\n  }\n\n  async update() {\n    this.setBusyState(true);\n    await User.update(this.state.form).then(() => {\n      this.users();\n      this.closeModal();\n      this.setBusyState(false);\n    }).catch(err => {\n      this.setBusyState(false);\n      console.log(err.response);\n    });\n  }\n\n  async delete(ids) {\n    this.setBusyState(true);\n    await User.destroy(ids).then(() => {\n      this.setBusyState(false);\n      this.users();\n      this.setState({\n        selected: []\n      });\n    }).catch(err => {\n      this.setBusyState(false);\n      console.log(err.response);\n    });\n  }\n\n  setBusyState(value) {\n    this.setState({\n      busy: value\n    });\n  }\n\n  setErrors(errors) {\n    this.setState({\n      errors\n    });\n  }\n\n  clearErrors() {\n    this.setErrors({\n      errors: {}\n    });\n  }\n\n  isSelected(_id) {\n    let exists = this.state.selected.find(id => {\n      return id === _id;\n    });\n    return exists ? true : false;\n  }\n\n  hasSelected() {\n    return this.state.selected.length ? true : false;\n  }\n\n  toggleSelected({\n    _id\n  }) {\n    let selected = [];\n\n    if (this.isSelected(_id)) {\n      selected = this.state.selected.filter(id => {\n        return id !== _id;\n      });\n    } else {\n      selected = [...this.state.selected, _id];\n    }\n\n    this.setState({\n      selected\n    });\n  }\n\n  show(user) {\n    this.changeMode(\"view\");\n    this.setState({\n      user: user\n    });\n    this.openModal();\n  }\n\n  changeMode(mode) {\n    this.setState({\n      mode: mode\n    });\n  }\n\n  add() {\n    this.changeMode(\"create\");\n    this.openModal();\n  }\n\n  edit(model) {\n    this.changeMode(\"edit\");\n    this.fill(model);\n    this.openModal();\n  }\n\n  closeModal() {\n    this.setState({\n      activeModal: false\n    });\n    this.clear();\n  }\n\n  openModal() {\n    this.setState({\n      activeModal: true\n    });\n  }\n\n  fill(model) {\n    this.setState({\n      form: model\n    });\n  }\n\n  clear() {\n    this.setState({\n      form: defaultForm\n    });\n  }\n\n  handleChange(event) {\n    const {\n      name,\n      value\n    } = event.target;\n    let params = {};\n    params[name] = value;\n    this.setState({\n      form: { ...this.state.form,\n        ...params\n      }\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n\n    if (this.state.mode === \"create\") {\n      this.store();\n    } else if (this.state.mode === \"edit\") {\n      this.update();\n    } else {\n      return null;\n    }\n  }\n\n  componentDidMount() {\n    this.users();\n  }\n\n  content() {\n    const {\n      users\n    } = this.state;\n\n    if (!users.length) {\n      return /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: /*#__PURE__*/_jsxDEV(\"td\", {\n          colSpan: \"2\",\n          children: \"No user found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this);\n    }\n\n    return users.map(user => /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => this.toggleSelected(user),\n          children: user._id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this), \" \", /*#__PURE__*/_jsxDEV(Badge, {\n          onClick: () => this.edit(user),\n          variant: \"success\",\n          children: \"edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Badge, {\n          className: \"ml-1\",\n          onClick: () => {\n            this.show(user);\n          },\n          variant: \"primary\",\n          children: \"view\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Badge, {\n          className: \"ml-1\",\n          onClick: () => this.delete([user._id]),\n          variant: \"danger\",\n          children: \"destroy\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this), this.isSelected(user._id) && /*#__PURE__*/_jsxDEV(Badge, {\n          className: \"ml-1\",\n          variant: \"info\",\n          children: \"selected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n        children: user.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this)]\n    }, user._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 7\n    }, this));\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-between mb-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Users\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex center\",\n          children: [this.state.busy && /*#__PURE__*/_jsxDEV(Spinner, {\n            className: \"mr-2\",\n            animation: \"border\",\n            role: \"status\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"sr-only\",\n              children: \"Loading...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: this.add,\n            size: \"md\",\n            variant: \"primary\",\n            children: \"Add\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this), this.hasSelected() && /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => this.delete(this.state.selected),\n            size: \"sm\",\n            className: \"ml-1\",\n            variant: \"danger\",\n            children: [\"Remove selected \", this.state.selected.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Table, {\n        striped: true,\n        bordered: true,\n        hover: true,\n        responsive: true,\n        size: \"sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"#\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: this.content()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        activeModal: this.state.activeModal,\n        closeModal: this.closeModal,\n        showSubmit: this.mode !== \"view\",\n        submitButton: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: this.handleSubmit,\n          children: \"Save Changes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 13\n        }, this),\n        children: this.state.mode === \"view\" ? /*#__PURE__*/_jsxDEV(UserComponent, {\n          user: this.state.user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Form, {\n          form: this.state.form,\n          handleChange: this.handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}","map":{"version":3,"sources":["/home/caio/Applications/mern-exercise-tracker/client/src/views/users/Users.js"],"names":["React","Table","Button","Badge","Spinner","UserComponent","Modal","Toast","User","Form","defaultForm","name","email","password","password_confirmation","_id","Users","Component","constructor","props","state","users","errors","user","busy","selected","activeModal","form","mode","closeModal","bind","openModal","setBusyState","toggleSelected","setErrors","clearErrors","show","store","update","delete","clear","fill","add","edit","changeMode","handleChange","handleSubmit","get","then","data","setState","catch","err","console","log","response","status","ids","destroy","value","isSelected","exists","find","id","hasSelected","length","filter","model","event","target","params","preventDefault","componentDidMount","content","map","render"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nimport { Table, Button, Badge, Spinner } from \"react-bootstrap\";\n\nimport UserComponent from \"./User\";\n\nimport Modal from \"../../components/Modal\";\n\nimport Toast from \"../../components/Toast\";\n\nimport User from \"../../api/User\";\n\nimport Form from \"./Form\";\n\n\nconst defaultForm = {\n  name: \"\",\n  email: \"\",\n  password: \"\",\n  password_confirmation: \"\",\n  _id: null,\n};\n\nexport default class Users extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      users: [],\n      errors: [],\n      user: null,\n      busy: false,\n      selected: [],\n      activeModal: false,\n      form: defaultForm,\n      mode: \"create\",\n    };\n\n    this.closeModal = this.closeModal.bind(this);\n    this.openModal = this.openModal.bind(this);\n    this.setBusyState = this.setBusyState.bind(this);\n    this.toggleSelected = this.toggleSelected.bind(this);\n    this.setErrors = this.setErrors.bind(this);\n    this.clearErrors = this.clearErrors.bind(this);\n\n    this.show = this.show.bind(this);\n    this.users = this.users.bind(this);\n    this.store = this.store.bind(this);\n    this.update = this.update.bind(this);\n    this.delete = this.delete.bind(this);\n\n    this.clear = this.clear.bind(this);\n    this.fill = this.fill.bind(this);\n    this.add = this.add.bind(this);\n    this.edit = this.edit.bind(this);\n\n    this.changeMode = this.changeMode.bind(this);\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  async users() {\n    this.setBusyState(true);\n    await User.get()\n      .then(({ data }) => {\n        this.setState({\n          users: data,\n        });\n        this.setBusyState(false);\n      })\n      .catch((err) => {\n        console.log(err.response);\n        this.setBusyState(false);\n      });\n  }\n\n  async store() {\n    await User.store(this.state.form)\n      .then(({ data }) => {\n        this.setState({\n          users: [...this.state.users, data],\n        });\n        this.closeModal();\n      })\n      .catch((err) => {\n        console.log(err.response);\n        if(err.response.status === 400){\n          this.setErrors(err.response.data.errors || [])\n        }\n      });\n  }\n\n  async update() {\n    this.setBusyState(true);\n    await User.update(this.state.form)\n      .then(() => {\n        this.users();\n        this.closeModal();\n        this.setBusyState(false);\n      })\n      .catch((err) => {\n        this.setBusyState(false);\n        console.log(err.response);\n      });\n  }\n\n  async delete(ids) {\n    this.setBusyState(true);\n    await User.destroy(ids)\n      .then(() => {\n        this.setBusyState(false);\n        this.users();\n\n        this.setState({\n          selected: [],\n        });\n      })\n      .catch((err) => {\n        this.setBusyState(false);\n        console.log(err.response);\n      });\n  }\n\n  setBusyState(value) {\n    this.setState({\n      busy: value,\n    });\n  }\n\n  setErrors(errors){\n    this.setState({\n      errors\n    })\n  }\n\n  clearErrors(){\n    this.setErrors({\n      errors: {}\n    })\n  }\n\n  isSelected(_id) {\n    let exists = this.state.selected.find((id) => {\n      return id === _id;\n    });\n\n    return exists ? true : false;\n  }\n\n  hasSelected() {\n    return this.state.selected.length ? true : false;\n  }\n\n  toggleSelected({ _id }) {\n    let selected = [];\n    if (this.isSelected(_id)) {\n      selected = this.state.selected.filter((id) => {\n        return id !== _id;\n      });\n    } else {\n      selected = [...this.state.selected, _id];\n    }\n\n    this.setState({\n      selected,\n    });\n  }\n\n  show(user) {\n    this.changeMode(\"view\");\n    this.setState({ user: user });\n    this.openModal();\n  }\n\n  changeMode(mode) {\n    this.setState({\n      mode: mode,\n    });\n  }\n\n  add() {\n    this.changeMode(\"create\");\n    this.openModal();\n  }\n\n  edit(model) {\n    this.changeMode(\"edit\");\n\n    this.fill(model);\n    this.openModal();\n  }\n\n  closeModal() {\n    this.setState({\n      activeModal: false,\n    });\n\n    this.clear();\n  }\n\n  openModal() {\n    this.setState({\n      activeModal: true,\n    });\n  }\n\n  fill(model) {\n    this.setState({ form: model });\n  }\n\n  clear() {\n    this.setState({ form: defaultForm });\n  }\n\n  handleChange(event) {\n    const { name, value } = event.target;\n    let params = {};\n    params[name] = value;\n\n    this.setState({ form: { ...this.state.form, ...params } });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    if (this.state.mode === \"create\") {\n      this.store();\n    } else if (this.state.mode === \"edit\") {\n      this.update();\n    } else {\n      return null;\n    }\n  }\n\n  componentDidMount() {\n    this.users();\n  }\n\n  content() {\n    const { users } = this.state;\n\n    if (!users.length) {\n      return (\n        <tr>\n          <td colSpan=\"2\">No user found</td>\n        </tr>\n      );\n    }\n\n    return users.map((user) => (\n      <tr key={user._id}>\n        <td>\n          <span onClick={() => this.toggleSelected(user)}>{user._id}</span>{\" \"}\n          <Badge onClick={() => this.edit(user)} variant=\"success\">\n            edit\n          </Badge>\n          <Badge\n            className=\"ml-1\"\n            onClick={() => {\n              this.show(user);\n            }}\n            variant=\"primary\"\n          >\n            view\n          </Badge>\n          <Badge\n            className=\"ml-1\"\n            onClick={() => this.delete([user._id])}\n            variant=\"danger\"\n          >\n            destroy\n          </Badge>\n          {this.isSelected(user._id) && (\n            <Badge className=\"ml-1\" variant=\"info\">\n              selected\n            </Badge>\n          )}\n        </td>\n        <td>{user.name}</td>\n      </tr>\n    ));\n  }\n\n  render() {\n    return (\n      <>\n        <div className=\"d-flex justify-content-between mb-1\">\n          <div>\n            <span>Users</span>\n          </div>\n          <div className=\"d-flex center\">\n            {this.state.busy && (\n              <Spinner className=\"mr-2\" animation=\"border\" role=\"status\">\n                <span className=\"sr-only\">Loading...</span>\n              </Spinner>\n            )}\n\n            <Button onClick={this.add} size=\"md\" variant=\"primary\">\n              Add\n            </Button>\n            {this.hasSelected() && (\n              <Button\n                onClick={() => this.delete(this.state.selected)}\n                size=\"sm\"\n                className=\"ml-1\"\n                variant=\"danger\"\n              >\n                Remove selected {this.state.selected.length}\n              </Button>\n            )}\n          </div>\n        </div>\n        <Table striped bordered hover responsive size=\"sm\">\n          <thead>\n            <tr>\n              <th>#</th>\n              <th>Name</th>\n            </tr>\n          </thead>\n\n          <tbody>{this.content()}</tbody>\n        </Table>\n        <Modal\n          activeModal={this.state.activeModal}\n          closeModal={this.closeModal}\n          showSubmit={this.mode !== \"view\"}\n          submitButton={\n            <Button variant=\"primary\" onClick={this.handleSubmit}>\n              Save Changes\n            </Button>\n          }\n        >\n          {this.state.mode === \"view\" ? (\n            <UserComponent user={this.state.user} />\n          ) : (\n            <Form form={this.state.form} handleChange={this.handleChange} />\n          )}\n        </Modal>\n      </>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}